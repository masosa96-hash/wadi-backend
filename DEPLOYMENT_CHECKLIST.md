# WADI Deployment Checklist

## üìã Pre-deployment Checklist

- [ ] Code committed and pushed to GitHub
- [ ] All environment variables identified
- [ ] Supabase project created and configured
- [ ] Groq API key obtained (or OpenAI API key)
- [ ] Node.js >= 20 installed locally
- [ ] pnpm >= 10.21.0 installed locally
- [ ] Vercel account created
- [ ] Render OR Railway account created

## ‚òÅÔ∏è Deployment Steps

### 1. Backend Deployment (Choose Render OR Railway)

#### Option A: Backend Deployment (Render)

- [ ] Go to Render Dashboard
- [ ] Click "New Web Service"
- [ ] Connect GitHub repository
- [ ] Select branch (main)
- [ ] Verify auto-detected settings:
  - Build Command: `cd apps/api && pnpm install --frozen-lockfile && pnpm build`
  - Start Command: `cd apps/api && pnpm start`
- [ ] Add Environment Variables:
  - [ ] `NODE_ENV=production`
  - [ ] `PORT=10000`
  - [ ] `FRONTEND_URL=` (will update later)
  - [ ] `SUPABASE_URL=`
  - [ ] `SUPABASE_ANON_KEY=`
  - [ ] `SUPABASE_SERVICE_KEY=`
  - [ ] `GROQ_API_KEY=`
  - [ ] `JWT_SECRET=` (auto-generated by Render)
- [ ] Click "Create Web Service"
- [ ] Note the deployed backend URL

#### Option B: Backend Deployment (Railway)

- [ ] Go to Railway Dashboard
- [ ] Click "New Project"
- [ ] Connect GitHub repository
- [ ] Select the repository
- [ ] Verify auto-detected settings from `railway.json`
- [ ] Add Environment Variables in Variables tab:
  - [ ] `SUPABASE_URL=`
  - [ ] `SUPABASE_ANON_KEY=`
  - [ ] `SUPABASE_SERVICE_KEY=`
  - [ ] `GROQ_API_KEY=`
  - [ ] `OPENAI_DEFAULT_MODEL=gpt-3.5-turbo`
  - [ ] `NODE_ENV=production`
  - [ ] `FRONTEND_URL=` (will update later)
- [ ] **IMPORTANT**: Create a secret named `JWT_SECRET` in Railway Variables/Secrets UI with your Supabase JWT secret value
- [ ] Click "Deploy" or wait for auto-deploy
- [ ] Note the deployed backend URL

### 2. Frontend Deployment (Vercel)

- [ ] Go to Vercel Dashboard
- [ ] Click "Add New Project"
- [ ] Import GitHub repository
- [ ] Configure project settings:
  - Project Name: (your choice)
  - Framework: Vite
  - Root Directory: `apps/frontend`
- [ ] Add Environment Variables:
  - [ ] `VITE_SUPABASE_URL=`
  - [ ] `VITE_SUPABASE_ANON_KEY=`
  - [ ] `VITE_API_URL=` (use backend URL from step 1)
  - [ ] `VITE_GUEST_MODE=true`
- [ ] Click "Deploy"
- [ ] Note the deployed frontend URL

### 3. Update Backend Configuration

#### If using Render:

- [ ] Go back to Render service settings
- [ ] Update `FRONTEND_URL` with your Vercel frontend URL
- [ ] Click "Save Changes" to redeploy backend

#### If using Railway:

- [ ] Go to Railway project Variables tab
- [ ] Update `FRONTEND_URL` with your Vercel frontend URL
- [ ] Railway will auto-redeploy

### 4. Supabase Configuration

- [ ] In Supabase project settings:
  - [ ] Add frontend URL to "Additional Redirect URLs"
  - [ ] Copy Service Role Key to backend as `SUPABASE_SERVICE_KEY`
- [ ] Run database migrations if needed

## ‚úÖ Post-deployment Verification

- [ ] Visit frontend URL in browser
- [ ] Test basic functionality
- [ ] Check backend health endpoint
- [ ] Verify authentication flow
- [ ] Test API endpoints
- [ ] Check WebSocket connection (chat functionality)

## üõ†Ô∏è Optional Enhancements

- [ ] Configure custom domains
- [ ] Set up monitoring and alerting
- [ ] Configure backup strategies
- [ ] Implement CI/CD pipelines
- [ ] Set up analytics
- [ ] Configure error tracking

## üÜò Troubleshooting

### Common Issues

1. **CORS Errors**
   - Verify `FRONTEND_URL` matches deployed frontend
   - Check Vercel domain is in CORS allowlist

2. **Environment Variables**
   - Double-check all required variables are set
   - Remember VITE\_ prefix for frontend variables

3. **Build Failures**
   - Check build logs in deployment dashboards
   - Verify all dependencies are in package.json

4. **API Connection Issues**
   - Confirm backend URL is correct in frontend config
   - Check backend health endpoint
   - Verify Supabase configuration

### Railway-Specific Issues

1. **JWT_SECRET Error**
   - Ensure you've created a secret named `JWT_SECRET` in Railway Variables/Secrets UI
   - The value should be your Supabase JWT secret (found in Supabase project settings)
   - Railway mounts secrets as files in `/secrets/JWT_SECRET` during build

## üí∞ Cost Considerations

- **Vercel**: Free tier sufficient for most applications
- **Render/Railway**: Free tier has limitations (sleeps after inactivity)
- **Supabase**: Free tier includes 500MB database
- **Groq**: Free tier includes generous API credits

For production use, consider upgrading to paid plans.
